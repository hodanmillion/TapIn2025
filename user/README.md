# User Service

Extended user profile and social features service built with Node.js, Express, TypeScript, and Prisma.

## ğŸ—ï¸ Service Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER SERVICE (Node.js + Express)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  PORT 3002                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ROUTE HANDLERS   â”‚    â”‚      SERVICES       â”‚    â”‚     DATA LAYER      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚    â”‚                     â”‚    â”‚                     â”‚
â”‚ ğŸ‘¤ Profile Routes   â”‚â”€â”€â”€â–¶â”‚ ğŸ—„ï¸ Cache Service    â”‚â”€â”€â”€â–¶â”‚ ğŸ—ƒï¸ PostgreSQL       â”‚
â”‚  â€¢ GET /me          â”‚    â”‚  â€¢ Redis Caching   â”‚    â”‚  â€¢ User Profiles    â”‚
â”‚  â€¢ PUT /me          â”‚    â”‚  â€¢ Cache Invalidationâ”‚    â”‚  â€¢ Social Relations â”‚
â”‚  â€¢ GET /:username   â”‚    â”‚                     â”‚    â”‚  â€¢ User Interests   â”‚
â”‚                     â”‚    â”‚ ğŸ“¤ Event Service    â”‚â”€â”€â”€â–¶â”‚  â€¢ Upload Metadata  â”‚
â”‚ ğŸ‘¥ Social Routes    â”‚â”€â”€â”€â–¶â”‚  â€¢ User Events      â”‚    â”‚                     â”‚
â”‚  â€¢ POST /follow     â”‚    â”‚  â€¢ Activity Stream  â”‚    â”‚ ğŸ”´ Redis Cache      â”‚
â”‚  â€¢ DELETE /unfollow â”‚    â”‚  â€¢ Notifications    â”‚    â”‚  â€¢ Profile Cache    â”‚
â”‚  â€¢ GET /followers   â”‚    â”‚                     â”‚    â”‚  â€¢ Search Cache     â”‚
â”‚  â€¢ GET /following   â”‚    â”‚ ğŸ” Search Service   â”‚â”€â”€â”€â–¶â”‚  â€¢ Social Cache     â”‚
â”‚                     â”‚    â”‚  â€¢ User Search      â”‚    â”‚                     â”‚
â”‚ ğŸ” Search Routes    â”‚â”€â”€â”€â–¶â”‚  â€¢ Fuzzy Matching   â”‚    â”‚ â˜ï¸ AWS S3           â”‚
â”‚  â€¢ GET /users       â”‚    â”‚  â€¢ Result Ranking   â”‚    â”‚  â€¢ Avatar Storage   â”‚
â”‚                     â”‚    â”‚                     â”‚    â”‚  â€¢ File Management  â”‚
â”‚ âš™ï¸ Settings Routes  â”‚â”€â”€â”€â–¶â”‚ ğŸ“ S3 Service       â”‚â”€â”€â”€â–¶â”‚                     â”‚
â”‚  â€¢ GET /preferences â”‚    â”‚  â€¢ File Upload      â”‚    â”‚ ğŸ”” Event Queue      â”‚
â”‚  â€¢ PUT /preferences â”‚    â”‚  â€¢ Image Processing â”‚    â”‚  â€¢ User Events      â”‚
â”‚  â€¢ POST /interests  â”‚    â”‚  â€¢ URL Generation   â”‚    â”‚  â€¢ Social Events    â”‚
â”‚                     â”‚    â”‚                     â”‚    â”‚  â€¢ System Events    â”‚
â”‚ ğŸ“ Upload Routes    â”‚â”€â”€â”€â–¶â”‚ ğŸ”„ Queue Service    â”‚â”€â”€â”€â–¶â”‚                     â”‚
â”‚  â€¢ POST /avatar     â”‚    â”‚  â€¢ Background Jobs  â”‚    â”‚                     â”‚
â”‚                     â”‚    â”‚  â€¢ Event Processing â”‚    â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                           â”‚                           â”‚
         â–¼                           â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              MIDDLEWARE LAYER                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”’ Auth Middleware    â”‚ ğŸ“ Validation         â”‚ ğŸ›¡ï¸ Error Handler              â”‚
â”‚  â€¢ JWT Verification   â”‚  â€¢ Request Validation â”‚  â€¢ Global Error Handling      â”‚
â”‚  â€¢ User Context      â”‚  â€¢ Schema Validation  â”‚  â€¢ HTTP Status Codes          â”‚
â”‚                       â”‚  â€¢ Sanitization       â”‚  â€¢ Error Logging              â”‚
â”‚ ğŸ“Š Logging           â”‚ ğŸ”§ Multer Upload      â”‚ âš¡ Performance                 â”‚
â”‚  â€¢ Request Logging    â”‚  â€¢ File Upload        â”‚  â€¢ Response Time              â”‚
â”‚  â€¢ Performance Logs  â”‚  â€¢ File Validation    â”‚  â€¢ Memory Usage               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Function Flow Diagram

### Profile Management Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GET PROFILEâ”‚    â”‚ UPDATE      â”‚    â”‚ SEARCH      â”‚    â”‚ UPLOAD      â”‚
â”‚     /me     â”‚    â”‚ PROFILE     â”‚    â”‚  USERS      â”‚    â”‚  AVATAR     â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚                  â”‚                  â”‚
      â–¼                  â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check Cache â”‚    â”‚ Validate    â”‚    â”‚ Check Cache â”‚    â”‚ Validate    â”‚
â”‚ for Profile â”‚    â”‚ Input Data  â”‚    â”‚ for Results â”‚    â”‚ File Type   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚                  â”‚                  â”‚
      â–¼                  â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ If Cached:  â”‚    â”‚ Update      â”‚    â”‚ If Cached:  â”‚    â”‚ Upload to   â”‚
â”‚ Return Data â”‚    â”‚ Database    â”‚    â”‚ Return Data â”‚    â”‚ S3 Bucket   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚                  â”‚                  â”‚
      â–¼                  â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ If Not:     â”‚    â”‚ Invalidate  â”‚    â”‚ If Not:     â”‚    â”‚ Update User â”‚
â”‚ Query DB    â”‚    â”‚ Cache       â”‚    â”‚ Query DB    â”‚    â”‚ Avatar URL  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚                  â”‚                  â”‚
      â–¼                  â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cache       â”‚    â”‚ Emit Event  â”‚    â”‚ Cache       â”‚    â”‚ Emit Event  â”‚
â”‚ Result      â”‚    â”‚ (Profile    â”‚    â”‚ Results     â”‚    â”‚ (Avatar     â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Updated)    â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Updated)    â”‚
      â”‚            â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚            â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â–¼                  â”‚                  â–¼                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â–¼            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â–¼
â”‚ Return      â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ Return      â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Profile     â”‚    â”‚ Return      â”‚    â”‚ Search      â”‚    â”‚ Return      â”‚
â”‚ Data        â”‚    â”‚ Updated     â”‚    â”‚ Results     â”‚    â”‚ Avatar URL  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Profile     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Social Features Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FOLLOW    â”‚    â”‚  UNFOLLOW   â”‚    â”‚ GET         â”‚    â”‚ GET         â”‚
â”‚    USER     â”‚    â”‚    USER     â”‚    â”‚ FOLLOWERS   â”‚    â”‚ FOLLOWING   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚                  â”‚                  â”‚
      â–¼                  â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validate    â”‚    â”‚ Validate    â”‚    â”‚ Check Cache â”‚    â”‚ Check Cache â”‚
â”‚ Target User â”‚    â”‚ Target User â”‚    â”‚ for List    â”‚    â”‚ for List    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚                  â”‚                  â”‚
      â–¼                  â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check Not   â”‚    â”‚ Check       â”‚    â”‚ If Cached:  â”‚    â”‚ If Cached:  â”‚
â”‚ Already     â”‚    â”‚ Following   â”‚    â”‚ Return List â”‚    â”‚ Return List â”‚
â”‚ Following   â”‚    â”‚ Exists      â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                  â”‚
      â”‚                  â”‚                  â–¼                  â–¼
      â–¼                  â–¼            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ If Not:     â”‚    â”‚ If Not:     â”‚
â”‚ Create      â”‚    â”‚ Delete      â”‚    â”‚ Query DB    â”‚    â”‚ Query DB    â”‚
â”‚ Follow      â”‚    â”‚ Follow      â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Record      â”‚    â”‚ Record      â”‚          â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â–¼                  â–¼
      â”‚                  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â–¼                  â–¼            â”‚ Cache       â”‚    â”‚ Cache       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ Results     â”‚    â”‚ Results     â”‚
â”‚ Update      â”‚    â”‚ Update      â”‚    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Counters    â”‚    â”‚ Counters    â”‚          â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â–¼                  â–¼
      â”‚                  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â–¼                  â–¼            â”‚ Return      â”‚    â”‚ Return      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ Follower    â”‚    â”‚ Following   â”‚
â”‚ Invalidate  â”‚    â”‚ Invalidate  â”‚    â”‚ List        â”‚    â”‚ List        â”‚
â”‚ Caches      â”‚    â”‚ Caches      â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚
      â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Emit Event  â”‚    â”‚ Emit Event  â”‚
â”‚ (Followed)  â”‚    â”‚ (Unfollowed)â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                  â”‚
      â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Return      â”‚    â”‚ Return      â”‚
â”‚ Success     â”‚    â”‚ Success     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”— API Endpoints

### Profile Management (`/api/v1/profile/`)
- **GET** `/me` - Get current user's extended profile
- **PUT** `/me` - Update user profile (display name, bio, location, etc.)
- **GET** `/:username` - Get public profile by username

### Social Features (`/api/v1/social/`)
- **POST** `/follow/:userId` - Follow another user
- **DELETE** `/unfollow/:userId` - Unfollow a user
- **GET** `/followers` - Get user's followers list
- **GET** `/following` - Get users that current user follows

### Search (`/api/v1/search/`)
- **GET** `/users?q=query` - Search users by name or username

### Settings (`/api/v1/settings/`)
- **GET** `/preferences` - Get user preferences and privacy settings
- **PUT** `/preferences` - Update user preferences
- **POST** `/interests` - Update user interests/tags

### File Upload (`/api/v1/upload/`)
- **POST** `/avatar` - Upload user avatar image

## ğŸ”§ Core Components

### Services
- **CacheService**: Redis-based caching for performance optimization
- **EventService**: Event publishing for inter-service communication
- **QueueService**: Background job processing
- **S3Service**: File upload and management

### Data Models (Prisma)
- **UserProfile**: Extended user information
- **Follow**: Social relationship tracking
- **UserInterest**: User interest/tag associations
- **UploadMeta**: File upload metadata

### Features
- **Profile Management**: Extended user profiles with rich metadata
- **Social Graph**: Follow/unfollow relationships with caching
- **User Search**: Fast fuzzy search with result caching
- **File Uploads**: Avatar management with S3 integration
- **Event System**: Real-time notifications and activity streams
- **Cache Strategy**: Multi-layer caching for optimal performance

## ğŸš€ Development

### Environment Variables
```bash
DATABASE_URL=postgresql://user:password@localhost:5432/user_db
REDIS_URL=redis://localhost:6379
AWS_ACCESS_KEY_ID=your-key
AWS_SECRET_ACCESS_KEY=your-secret
AWS_REGION=us-east-1
S3_BUCKET_NAME=user-uploads
EVENT_SERVICE_URL=http://localhost:8002
```

### Running the Service
```bash
npm install
npm run dev
```

### Database Operations
```bash
# Run migrations
npx prisma migrate dev

# Generate Prisma client
npx prisma generate

# Reset database
npx prisma migrate reset
```

## ğŸ§ª Testing
```bash
# Run all tests
npm test

# Run tests with coverage
npm run test:coverage

# Run integration tests
npm run test:integration
```

### Test Coverage Areas
- Route handlers with various input scenarios
- Service layer logic and error handling
- Cache invalidation strategies
- File upload validation and processing
- Social relationship edge cases